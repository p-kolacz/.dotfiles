#!/bin/bash

id=$(xinput | grep -oP "Touchpad.*id=\K\d+")
[[ -z $id ]] && { echo "No touchpad found."; exit 1; } 

toggle() {
	enabled=$(xinput --list-props $id | grep -oP "Device Enabled.*:.*\K\d")
	[[ $enabled -eq 0 ]] && opt=enable || opt=disable
	xinput $opt $id \
		&& notify-send Touchpad ${opt}d \
		|| notify-send Touchpad "failed to $opt"
}

dwt_toggle() {
	opt=$(xinput --list-props $id | grep -oP "Disable While Typing Enabled \(\K\d+")
	enabled=$(xinput --list-props $id | grep -oP "Disable While Typing Enabled \(\d+\):\s+\K\d")
	((enabled = !enabled))
	xinput set-prop $id $opt $enabled \
		&& notify-send "Touchpad" "DWT set to $enabled" \
		|| notify-send "Touchpad" "set-prop failed"
}

case $1 in
	toggle)		toggle ;;
	dwt-toggle)	dwt_toggle ;;
	*)			echo "Usage: touchpad { toggle | dwt-toggle }"
esac

